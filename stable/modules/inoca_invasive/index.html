<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>INOCA – Pathway Chooser</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/stable/style.css" />
</head>

<body>
  <div class="app-shell">
    <header class="app-header">
      <div>
        <h1 class="app-title">
          INOCA Pathways
          <span class="info-chip info-chip--inline" data-modal="modal-scope" title="Scope">i</span>
          <span class="info-chip info-chip--warn" data-modal="modal-redflags" title="Red flags / exclusions">!</span>
        </h1>
        <p class="app-subtitle">
          Choose an INOCA diagnostic strategy. Optional reading only; does not block.
        </p>
      </div>
      <div class="app-meta">
        <a class="btn-secondary" href="/stable/index.html">← Stable home</a>
      </div>
    </header>

    <main class="app-main">
      <section class="card card-inputs">
        <h2 class="card-title">Start</h2>

        <div class="form-grid">
          <div class="callout">
            <strong>When to suspect INOCA (optional)</strong>
            <ul>
              <li>Persistent/recurrent angina with nonobstructive findings.</li>
              <li>Symptoms disproportionate to anatomic disease burden.</li>
              <li>Testing does not explain symptoms or is non-diagnostic.</li>
            </ul>
          </div>

          <!-- NEW: Noninvasive chooser -->
          <a class="btn-primary btn-primary--full" href="/stable/modules/inoca_noninvasive/index.html">
            Noninvasive INOCA testing
          </a>

          <!-- Direct links (kept for power users) -->
          <a class="btn-secondary btn-secondary--full" href="/stable/modules/inoca_pet_cmr/index.html">
            Stress PET / Stress CMR (MBFR) — COR 2a
          </a>

          <a class="btn-secondary btn-secondary--full" href="/stable/modules/inoca_echo_cfvr/index.html">
            Stress echo (CFVR) — COR 2b
          </a>

          <a class="btn-secondary btn-secondary--full" href="/stable/modules/inoca_invasive_testing/index.html">
            Invasive coronary function testing — COR 2a
          </a>

          <div class="callout" style="margin-top:0.75rem;">
            <strong>Notes</strong>
            <ul>
              <li>These modules summarize pathway buckets; they do not calculate numeric thresholds.</li>
              <li>Use local protocols and specialist input for testing selection and management.</li>
            </ul>
          </div>
        </div>
      </section>

      <section class="card card-results">
        <h2 class="card-title">Navigation</h2>
        <div class="results-body">
          <p class="results-placeholder">
            Use “Noninvasive INOCA testing” for the guided path, or open a specific module directly.
          </p>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <p class="disclaimer">
        This tool is for educational and decision-support purposes only. It does not replace clinical judgment,
        institutional guidelines, or specialist consultation.
      </p>
    </footer>
  </div>

  <!-- Modals -->
  <div class="modal-backdrop" id="modal-backdrop" aria-hidden="true"></div>

  <div class="modal" id="modal-scope" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-header">
        <h3>Scope</h3>
        <button class="modal-close" data-close="true">×</button>
      </div>
      <div class="modal-body">
        <ul>
          <li>Stable chest pain + suspected INOCA chooser.</li>
          <li>Routes to noninvasive testing (PET/CMR MBFR, Echo CFVR) and invasive phenotyping.</li>
          <li>Does not replace clinical judgment or institutional protocols.</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="modal" id="modal-redflags" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-header">
        <h3>Red flags / exclusions</h3>
        <button class="modal-close" data-close="true">×</button>
      </div>
      <div class="modal-body">
        <ul>
          <li>Concern for ACS / unstable features</li>
          <li>Hemodynamic instability or severe arrhythmia</li>
          <li>Severe respiratory distress</li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    // Modal wiring (kept lightweight; no external dependencies)
    document.addEventListener("DOMContentLoaded", () => {
      const backdrop = document.getElementById("modal-backdrop");
      const triggers = document.querySelectorAll("[data-modal]");
      const closeBtns = document.querySelectorAll("[data-close='true']");

      function openModal(id) {
        const modal = document.getElementById(id);
        if (!modal) return;
        modal.classList.add("is-open");
        backdrop.classList.add("is-open");
        modal.setAttribute("aria-hidden", "false");
        backdrop.setAttribute("aria-hidden", "false");
      }

      function closeAll() {
        document.querySelectorAll(".modal.is-open").forEach((m) => {
          m.classList.remove("is-open");
          m.setAttribute("aria-hidden", "true");
        });
        backdrop.classList.remove("is-open");
        backdrop.setAttribute("aria-hidden", "true");
      }

      triggers.forEach((t) => t.addEventListener("click", () => openModal(t.getAttribute("data-modal"))));
      closeBtns.forEach((b) => b.addEventListener("click", closeAll));
      backdrop && backdrop.addEventListener("click", closeAll);

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") closeAll();
      });
    });
  </script>
</body>
</html>
